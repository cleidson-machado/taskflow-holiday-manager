# ========================================
# DATABASE CONFIGURATION
# ========================================
# PostgreSQL connection settings with environment variable fallback
# Best practice: Use env vars in production, defaults for local development
quarkus.datasource.db-kind=postgresql
quarkus.datasource.jdbc.url=${QUARKUS_DATASOURCE_JDBC_URL:jdbc:postgresql://localhost:5432/system_vacation_db}
quarkus.datasource.username=${QUARKUS_DATASOURCE_USERNAME:quarkus}
quarkus.datasource.password=${QUARKUS_DATASOURCE_PASSWORD:quarkus123}

# ========================================
# HIBERNATE ORM CONFIGURATION
# ========================================
# CRITICAL: Schema management delegated to Flyway (not Hibernate)
# This ensures controlled, versioned database migrations
quarkus.hibernate-orm.database.generation=none
quarkus.hibernate-orm.log.sql=true

# REMOVED: quarkus.hibernate-orm.sql-load-script (Flyway manages schema)
# REMOVED: quarkus.hibernate-orm.sql-load-script-phase (no longer needed)

# ========================================
# FLYWAY MIGRATION CONFIGURATION
# ========================================
# Automatically execute migrations on application startup
quarkus.flyway.migrate-at-start=true

# Create flyway_schema_history table if it doesn't exist
# Useful for existing databases without Flyway history
quarkus.flyway.baseline-on-migrate=true

# Initial baseline version (useful for legacy databases)
quarkus.flyway.baseline-version=0

# Location of migration scripts (src/main/resources/db/migration)
quarkus.flyway.locations=db/migration

# ========================================
# ENVIRONMENT PROFILES (DEV vs PROD)
# ========================================
# DEV: Clean and recreate database on every startup (for rapid development)
%dev.quarkus.flyway.clean-at-start=true

# PROD: NEVER clean the database (data preservation)
%prod.quarkus.flyway.clean-at-start=false

# DEV: Disable Hibernate schema validation (Flyway has full control)
%dev.quarkus.hibernate-orm.database.generation=none
%dev.quarkus.hibernate-orm.validate-in-dev-mode=false

# ========================================
# CORS CONFIGURATION
# ========================================
# NOTE: For technical assessment/demo purposes only
# PRODUCTION: Restrict origins to specific domains for security
# quarkus.http.cors=true
# quarkus.http.cors.origins=https://yourdomain.com,https://app.yourdomain.com
# quarkus.http.cors.methods=GET,POST,PUT,DELETE,PATCH
# quarkus.http.cors.headers=accept,authorization,content-type,x-requested-with
# quarkus.http.cors.exposed-headers=Content-Disposition
# quarkus.http.cors.access-control-max-age=24H

# ========================================
# HTTP SERVER CONFIGURATION
# ========================================
# Bind to all network interfaces (useful for Docker/containers)
quarkus.http.host=0.0.0.0

# Application port (default: 8080)
quarkus.http.port=8080

# ========================================
# HTTPS/SSL CONFIGURATION
# ========================================
# NOTE: Commented out for technical assessment
# PRODUCTION: Enable HTTPS with valid certificates (Let's Encrypt, etc.)
# quarkus.http.ssl.port=8443
# quarkus.http.ssl.certificate.key-store-file=security/keystore.p12
# quarkus.http.ssl.certificate.key-store-password=changeit
# quarkus.http.insecure-requests=redirect

# ========================================
# SWAGGER/OPENAPI DOCUMENTATION
# ========================================
# Always include Swagger UI (even in production for this demo)
# PRODUCTION: Consider disabling in prod or protecting with authentication
quarkus.swagger-ui.always-include=true
quarkus.swagger-ui.path=/q/swagger-ui

# OpenAPI document configuration
quarkus.smallrye-openapi.path=/q/openapi
quarkus.smallrye-openapi.info-title=TaskFlow Holiday Manager API
quarkus.smallrye-openapi.info-version=1.0.0
quarkus.smallrye-openapi.info-description=REST API for managing employeeRecordModels and vacation requests with role-based access control
quarkus.smallrye-openapi.info-contact-name=LBC Technical Assessment
quarkus.smallrye-openapi.info-contact-email=support@taskflow.com

# ========================================
# LOGGING CONFIGURATION
# ========================================
# Log level for application packages
quarkus.log.level=INFO
quarkus.log.category."com.global.lbc".level=DEBUG

# DEV: More verbose logging for troubleshooting
%dev.quarkus.log.console.format=%d{HH:mm:ss} %-5p [%c{2.}] (%t) %s%e%n

# ========================================
# ADDITIONAL PRODUCTION CONSIDERATIONS
# ========================================
# Health checks (uncomment for production/Kubernetes deployments)
# quarkus.smallrye-health.root-path=/q/health

# Metrics (uncomment for monitoring with Prometheus/Grafana)
# quarkus.micrometer.export.prometheus.enabled=true
# quarkus.micrometer.export.prometheus.path=/q/metrics

# Connection pool tuning (uncomment for high-traffic production)
# quarkus.datasource.jdbc.min-size=5
# quarkus.datasource.jdbc.max-size=20
# quarkus.datasource.jdbc.acquisition-timeout=10

# Transaction timeout (uncomment if needed)
# quarkus.transaction-manager.default-transaction-timeout=60s